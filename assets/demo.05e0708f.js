import"./index.e9091200.js";import{d as p,b8 as $,c as r,F as y,a as d}from"./runtime-core.esm-bundler.6c7eec45.js";function w(t,{maxCount:n=3,retryInterval:e=1e3,onRetry:o=u=>{},onFailed:i=(u,c)=>{}}={}){return function(...c){return new Promise((h,g)=>{let a=0;const m=this;l();function l(){o(++a),t.call(m,...c).then((...s)=>{h(...s)}).catch((...s)=>{a>=n?(i(a,s),g(...s)):(i(a,s),setTimeout(l,e))})}})}}function b(t){return t&&t.constructor===Object}function f(t){if(typeof t=="string")return t;if(t instanceof Error)return`${t.name}: ${t.message}`;if(b(t)){if(typeof t.msg=="string")return t.msg;if(typeof t.message=="string")return t.message}return JSON.stringify(t)}function v(t){return console.log("fetching",t),fetch(`https://httpbin.org/status/200,500,400?keywords=${t}`,{method:"GET",mode:"cors"}).then(n=>{if(n.status>=200&&n.status<300)return{data:`result for ${t}`};throw new Error(n.statusText||`request failed with status ${n.status}`)})}var T=p({setup(){const t=$([]),n=w(v,{maxCount:3,retryInterval:1e3,onFailed(e,[o]){t.value.push(`${Date.now()} \u7B2C${e}\u6B21\u5931\u8D25\u4E86\uFF1A${f(o)}`)},onRetry(e){t.value.push(`${Date.now()} \u6B63\u5728\u8FDB\u884C\u7B2C${e}\u6B21\u5C1D\u8BD5...`)}});return()=>r(y,null,[r("button",{onClick:async()=>{try{t.value=[];const e=await n("abc");t.value.push(`${Date.now()} onSuccess: ${JSON.stringify(e)}`)}catch(e){t.value.push(`${Date.now()} onError: ${f(e)}`)}}},[d("Get something unstable")]),r("pre",null,[t.value.join(`
`)])])}});export{T as default};
