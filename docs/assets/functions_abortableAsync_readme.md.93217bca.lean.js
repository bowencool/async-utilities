import{d as g,r as f,c as p,F as h,a as u,b as y,e as i,o as w}from"./app.00a19c4d.js";class k extends Error{constructor(n){super(n);this.name="AbortError"}}class b extends Error{constructor(n){super(n);this.name="TimeoutError"}}function v(s,n={}){return function(...t){return new Promise((m,o)=>{let e;function l(){o(new k("aborted"))}function d(){o(new b(`timeout of ${n.timeout}ms`))}typeof n.timeout=="number"&&n.timeout>0&&(e=setTimeout(d,n.timeout)),n.signal&&n.signal.addEventListener("abort",l);function r(){e&&clearTimeout(e),n.signal&&n.signal.removeEventListener("abort",l)}s.call(this,...t).then((...c)=>{m(...c),r()}).catch((...c)=>{o(...c),r()})})}}function _(s=1e3){return new Promise(n=>{console.log(`The task will be completed in ${s}ms`),setTimeout(()=>n(`The result in ${s}ms`),s)})}var T=g({setup(){let s;const n=f({loading:!1,error:null,data:""});return()=>p(h,null,[p("p",null,[u("fetch\u3001xhr \u539F\u751F\u5C31\u53EF\u4EE5\u53D6\u6D88\uFF0C\u6240\u4EE5\u8FD9\u91CC\u5C31\u4E0D\u7528 HTTP \u505A\u793A\u4F8B\u4E86")]),p("button",{onClick:async function(){if(!n.loading){s=new AbortController;try{n.loading=!0,n.error=null,n.data=await v(_,{timeout:2e3,signal:s.signal})(1900+Math.floor(Math.random()*200))}catch(a){console.log(a.name,a.message,a instanceof b,a instanceof k),n.error=a,n.data=""}finally{n.loading=!1}}},disabled:n.loading?!0:void 0},[n.loading?"loading...":"start"]),n.loading&&p("button",{onClick:()=>{s.abort()}},[u("stop")]),p("pre",null,[JSON.stringify(n,(a,t)=>t instanceof Error?t.message:t,2)])])}});const A=i("",4),E=i("",3),S='{"title":"Intro","description":"","frontmatter":{},"headers":[{"level":2,"title":"Intro","slug":"intro"},{"level":2,"title":"Demo","slug":"demo"},{"level":2,"title":"Types","slug":"types"}],"relativePath":"../src/abortableAsync/readme.md","lastUpdated":1632281211378}',C={},x=Object.assign(C,{setup(s){return(n,a)=>(w(),y("div",null,[A,p(T),E]))}});export{S as __pageData,x as default};
