import{d as n,e as s,f as a,o as p,c as t,b as o,a as e}from"./app.8b62bbc9.js";function l(n,{useSamePromise:s=!1}={}){let a=!1,p=null;return function(...t){if(a)return s&&p?p:new Promise((()=>{}));{const s=n.call(this,...t).then(((...n)=>(a=!1,p=null,Promise.resolve(...n)))).catch(((...n)=>(a=!1,p=null,Promise.reject(...n))));return p=s,a=!0,s}}}const c=l((function(n){return console.log("submiting",n),fetch("https://httpbin.org/delay/1.5",{body:JSON.stringify(n),method:"POST",mode:"cors"})}));var r=n({setup:()=>()=>s("fieldset",null,[s("legend",null,[a("提交场景")]),s("ul",null,[s("li",null,[a("背景：为防止用户重复提交，我们通常需要维护一个 loading 变量，当 loading 数量多起来就难搞了（我也想偷懒）。")]),s("li",null,[a("需求：不需要写 loading，也可以去重")]),s("li",null,[a("原文：https://github.com/bowencool/blog/issues/3")])]),s("button",{onClick:async()=>{await c({msg:"some data to be sent"}),console.log("submit completed")}},[a("submit(click me quickly)")])])});const u=l((function(n){console.log("fetching",n);const s=(.4+2*Math.random()).toFixed(3);return fetch(`https://httpbin.org/delay/${s}?keywords=${n}`,{method:"GET",mode:"cors"}).then((()=>({data:`result for ${n}`})))}),{useSamePromise:!0});var i=n({setup:()=>()=>s("fieldset",null,[s("legend",null,[a("查询场景")]),s("ul",null,[s("li",null,[a("背景：多个地方需要同一份数据，往往调用（请求）多次。")]),s("li",null,[a("需求：执行（请求）一次，返回同一个结果给多个调用方。")])]),s("button",{onClick:async()=>{const n=await u("abc");console.log("fetched",n)}},[a("Get something same(useSamePromise)")])])});const k=o("h2",{id:"intro",tabindex:"-1"},[a("Intro "),o("a",{class:"header-anchor",href:"#intro","aria-hidden":"true"},"#")],-1),b=o("p",null,"短时间内触发多次，取第一次（仅执行一次）的执行结果。",-1),m=o("p",null,"换句话说，上一个 Promise 结束之前，不会重复执行，直接返回正在 pending 的 Promise。",-1),d=o("h2",{id:"demo",tabindex:"-1"},[a("Demo "),o("a",{class:"header-anchor",href:"#demo","aria-hidden":"true"},"#")],-1),g=o("blockquote",null,[o("p",null,"demo 以网络请求为例，请打开 Devtool -> Network 查看效果")],-1),h=e('',1),f=e('',3),y='{"title":"Intro","description":"","frontmatter":{},"headers":[{"level":2,"title":"Intro","slug":"intro"},{"level":2,"title":"Demo","slug":"demo"},{"level":2,"title":"Types","slug":"types"}],"relativePath":"functions/throttleAsync/readme.md","lastUpdated":1631455426312}',v={};const w=Object.assign(v,{setup:function(n){return(n,a)=>(p(),t("div",null,[k,b,m,d,g,s(r),h,s(i),f]))}});export{y as __pageData,w as default};
