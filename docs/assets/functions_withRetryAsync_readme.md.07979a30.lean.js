import{d as n,f as s,h as a,o as t,c as p,b as e,a as o}from"./app.ac6ed4dc.js";const c=function(n,{maxCount:s=3,retryInterval:a=500,onRetry:t=((n,s)=>{})}={}){return function(...p){return new Promise(((e,o)=>{let c=0,l=[];const u=this;!function r(){t(c,l),n.call(u,...p).then(((...n)=>{e(...n)})).catch(((...n)=>{++c>=s?o(...n):(l=n,setTimeout(r,a))}))}()}))}}((function(n){return console.log("fetching",n),fetch(`https://httpbin.org/status/200,500,400?keywords=${n}`,{method:"GET",mode:"cors"}).then((s=>{if(s.status>=200&&s.status<300)return{data:`result for ${n}`};throw new Error(s.statusText||`request failed with status ${s.status}`)}))}),{maxCount:3,retryInterval:1e3,onRetry(n,[s]){let a=s;s instanceof Error&&(a=s.message),console.log(a,`第${n+1}次尝试...`)}});var l=n({setup:()=>()=>s("button",{onClick:async()=>{const n=await c("abc");console.log("fetched",n)}},[a("Get something unstable")])});const u=e("h2",{id:"intro",tabindex:"-1"},[a("Intro "),e("a",{class:"header-anchor",href:"#intro","aria-hidden":"true"},"#")],-1),r=e("p",null,"一个可以让异步任务支持重试的高阶函数。",-1),i=e("p",null,"A higher-order function that allows asynchronous tasks to support retries.",-1),k=e("h2",{id:"demo",tabindex:"-1"},[a("Demo "),e("a",{class:"header-anchor",href:"#demo","aria-hidden":"true"},"#")],-1),b=e("blockquote",null,[e("p",null,"以下 Demo 以网络请求为例，打开 Devtool 查看效果。"),e("p",null,"The following demo takes a network request as an example and opens Devtool to see the effect.")],-1),m=o('',3),d='{"title":"Intro","description":"","frontmatter":{},"headers":[{"level":2,"title":"Intro","slug":"intro"},{"level":2,"title":"Demo","slug":"demo"},{"level":2,"title":"Types","slug":"types"}],"relativePath":"functions/withRetryAsync/readme.md","lastUpdated":1632281211386}',g={};const h=Object.assign(g,{setup:function(n){return(n,a)=>(t(),p("div",null,[u,r,i,k,b,s(l),m]))}});export{d as __pageData,h as default};
